<!DOCTYPE html>
{% load static %}
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Django File Upload</title>

    <link rel="stylesheet" type="text/css" href="{% static 'bootstrap.min.css' %}">

    <style>

        * {
            font-family: sans-serif;
        }

        html, body {
            background-color: #FBFAFE;
            text-align: center;
            width: 100%;
            height: 635px;
            margin: 0px;
        }

        form {
            padding: 25px;
        }

        input {
            margin: 10px;
        }

        table {
            margin: 0 auto;
            width: 95%;
            text-align: center;
            margin-top: 25px;
            padding: 25px;
            font-size: 10pt;
        }

        table tr td {
            padding-top: 15px;            
        }

        .navbar{
            background: linear-gradient(to right, #6c5ce7, #81ecec);
        }

        .navbar a{
            color: white;
            font-size: 20pt;
            font-weight: bolder;
        }

        .navbar ul{
            padding: 0px;
            margin: 0px;
            display: flex;
        }

        .navbar li{
            list-style:none;
            padding:0px;
            padding-left: 15px;
            margin: 0px;
        }

        #username_design {
            font-size: 15pt;
            font-weight: normal;
        }

        #logout_design{
            display:inline-block;
            text-align:center;
            vertical-align: center;
            width: 100px;
            height: 35px;
            background-color: #F0F0F0;
            color: dimgrey;
            border-radius: 15px;
            border: 0;
            outline: 0;
            font-size: 10pt;
        }

        aside {
            width: 30%;
            height: 100%;
            float: left;
            background-color: #FBFAFE;
            margin: 0 auto;
        }

        .form_box {
            display: inline-block;
            width: 80%;
            height: 80%;
            text-align: center;
            background-color: #ffffff;
            border-radius: 15px;
            margin: 0 auto;
            margin-top: 60px;
            box-shadow: 5px 5px 10px 5px #ECE8FC;
        }

        #form_title {
            width: 100%;
            height: 100px;
            color: white;
            background-color: #6c5ce7;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            display: table;
            text-align: center;
        }

        #form_inner_box {
            margin: 0 auto;
            width: 100%;
            text-align: left;
            border: #1b1e21;
        }

        .form_text {
            font-weight: bolder;
            font-size: 10pt;
            color: #6c5ce7;
            margin-top: 10px;
        }

        #form_inner_box input {
            margin-left: 0px;
        }

        .text_input {
            padding: 5px;
            border-color: #E5E5E5;
            border-style: dashed;
            border-radius: 10px;
        }

        #submit_bnt {
            width: 50%;
            height: 50px;
            border-radius: 30px;
            color: white;
            background-color: #6c5ce7;
            border: 0;
            outline: 0;
            font-weight: bolder;
            text-align: center;
            margin-top: 30px;
            box-shadow: 5px 5px 10px 5px #ECE8FC;
        }

        aside h1 {
            text-align: center;
            color: white;
            font-weight: bolder;
        }

        section {
            width: 70%;
            float: right;
            background-color: #FBFAFE;
        }

        section h1 {
            margin-top: 60px;
            margin-bottom: 20px;
            color: #6c5ce7;
            text-align: left;
            font-weight: bolder;
            font-size: 20pt;
        }

        .meter {
            height: 20px;
            width: 95%;
            background: #C6C6C6;
            border-radius: 25px;
            margin: 10px;
            box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3);
        }

        .meter > span {
            display: block;
            height: 100%;
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
            border-top-left-radius: 20px;
            border-bottom-left-radius: 20px;
            background-color: #6c5ce7;
            background-image: linear-gradient(to right, #6c5ce7, #81ecec);
            box-shadow: inset 0 2px 9px  rgba(255,255,255,0.3), inset 0 -2px 6px rgba(0,0,0,0.4);
            position: relative;
            overflow: hidden;
        }

        #myProgress {
            height: 20px;
            width: 95%;
            background: #C6C6C6;
            border-radius: 25px;
            margin: 10px;
            box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3);
        }

        #myBar {
            display: block;
            height: 100%;
            width: {{progress_num}}%;
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
            border-top-left-radius: 20px;
            border-bottom-left-radius: 20px;
            background-color: #6c5ce7;
            background-image: linear-gradient(to right, #6c5ce7, #81ecec);
            box-shadow: inset 0 2px 9px  rgba(255,255,255,0.3), inset 0 -2px 6px rgba(0,0,0,0.4);
            position: relative;
            overflow: hidden;
        }

        #label {
        text-align: center;
        line-height: 30px;
        color: white;
        }

        section h3 {
            margin-top: 10px;
            color: #474747;
            text-align: center;
            font-weight: normal;
            font-size: 12pt;
        }

        footer {
            background-color: #F0F0F0;
            clear:both;
        }

    </style>
</head>
<body>
    <nav class="navbar">
        <a class="navbar-brand" href="{% url 'upload:upload_files' %}">SNOWBOARD</a>
        <ul>
            <li><a id="username_design" href="">Welcome, {{ user.username }} !</a></li>
            <li><button id="logout_design" onclick = "location.href = '{% url 'common:login' %}' ">LOGOUT</button></li>
        </ul>
    </nav>

    <aside>
        <div class="form_box">
            <div id="form_title">
                <div style="padding: 10px; font-size: 15pt; font-weight: bolder; text-align: center; display: table-cell; vertical-align: middle;">Submit a lecture file</div>
            </div>
            <form id="file_form" action="{% url 'upload:upload_files' %}" method="POST" enctype="multipart/form-data">
                <div id="form_inner_box">
                    <div class="form_text">Lecture Title</div>
                    <input class="text_input" type="text" name="fileTitle" placeholder="Enter a title">
                    <div class="form_text">Choose Lecture Video(.mp4)</div>
                    <input class="text_input" type="file" name="videoFile">
                    <div class="form_text">Choose Lecture Material(.pdf)</div>
                    <input class="text_input" type="file" name="docFile">
                    {% csrf_token %}
                </div>
                <button id="submit_bnt" type="submit" value="Upload" onclick="move()">Upload</button>
            </form>
        </div>
    </aside>

    <section>
        <h1>Task Loading</h1>

        <div id="myProgress">
        <div id="myBar">
            <div id="label">{{progress_num}}%</div>
        </div>
        </div>

        <h3 id="pro_text">진행상태 {{progress_num}}%</h3>
        <p>{{sertime}}</p>
        <p>{{user_name}}</p>

        <h1>Lecture list uploaded to server</h1>

        <table>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Video File Path</th>
                <th>Doc File Path</th>
                <th>Upload Date & Time</th>
            </tr>
            {% for file in files %}
                <tr>
                    <td>{{ file.id }}</td>
                    <td>{{ file.title }}</td>
                    <td>{{ file.videoFile.url }}</td>
                    <td>{{ file.docFile.url }}</td>
                    <td>{{ file.dateTimeOfUpload }}</td>
                </tr>
            {% endfor %}
        </table>
    </section>

    <footer>
        <p>Copyright © 2021 Team Commentor</p>
    </footer>

<script>
    function move() {
        var elem = document.getElementById("myBar");
        var pro_text = document.getElementById("pro_text");
        var width = 0;
        var id = setInterval(frame, {{sertime}});
        function frame() {
            if (width >= 100) {
            clearInterval(id);
            document.getElementById("pro_text").innerHTML = '진행상태 ' + width * 1  + '% : 완료되었습니다.';
            }
            else if(width <= 10){
            width++;
            elem.style.width = width + '%';
            document.getElementById("label").innerHTML = width * 1  + '%';
            document.getElementById("pro_text").innerHTML = '진행상태 ' + width * 1  + '% : 파일 업로드 요청을 하고 있습니다.';
            }
            else if(width <= 20){
            width++;
            elem.style.width = width + '%';
            document.getElementById("label").innerHTML = width * 1  + '%';
            document.getElementById("pro_text").innerHTML = '진행상태 ' + width * 1  + '% : 파일을 저장하고 있습니다.';
            }
            else if(width <= 70){
            width++;
            elem.style.width = width + '%';
            document.getElementById("label").innerHTML = width * 1  + '%';
            document.getElementById("pro_text").innerHTML = '진행상태 ' + width * 1  + '% : 저장된 파일로 commentor 서비스를 실행하고 있습니다.';
            }
            else if(width <= 85){
            width++;
            elem.style.width = width + '%';
            document.getElementById("label").innerHTML = width * 1  + '%';
            document.getElementById("pro_text").innerHTML = '진행상태 ' + width * 1  + '% : 부가 파일들 저장하고 있습니다.';
            }
            else if(width < 100){
            width++;
            elem.style.width = width + '%';
            document.getElementById("label").innerHTML = width * 1  + '%';
            document.getElementById("pro_text").innerHTML = '진행상태 ' + width * 1  + '% : 부가 파일들 경로를 db에 저장하고 있습니다.';
            }
        }
    }

</script>

</body>
</html>